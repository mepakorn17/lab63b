# การทดลองที่ 7 การตรวจจับแสงผ่านเซ็นเซอร์แสงและเครื่องตัวจับความเข้มแสง

## วัตุประสงค์
1. เพื่อประยุกต์ใช้ Microcontroller กับเครื่องตัวจับความเข้มแสง

2. เพื่อศึกษาวิธีการประยุกต์ใช้โปรแกรมให้มีความซับซ้อนมากขึ้น

## อุปกรณ์ที่ใช้
1. Microcontroller (ESP-01)

2.คอมพิวเตอร์ หรือ โน้ตบุ๊ค

3. สาย USB เพื่อต่อไปยังอุปกรณ์ Serial

4. adepter สำหรับเสียบผ่านพอท 0,1

5. หลอดไฟ LED 

6. ตัวโปรแกรม output สัญญาณ

7. ตัว senser แสง

8. เครื่องตัวจับความเข้มแสง

## ศึกษาข้อมูลเบื้องต้น

04 run example 4 https://youtu.be/nFqoZT26U5k

ความเข้มแสง https://www.neonics.co.th/illumination/introduction-to-light-intensity.html

หลักการทำงานเซ็นเซอร์แสง https://sites.google.com/a/rsu.ac.th/kar-peid-pid-fi-dwy-saeng/home/2222/hlak-kar-thangan-khxng-photo-switch

## วิธีทำการทดลอง
1. เชื่อมต่อ usb to Serial กับสาย adapter พอท 0,1 และต่อ Micorcontroller เข้าไปด้านบนดังรูป

![image](https://user-images.githubusercontent.com/80879791/113162693-b3c22a80-9269-11eb-88fa-ccdf1475632b.png)

2. ต่อสายโยงเชื่อม เซ็นเซอร์แสงและหลอดไฟ LED เครื่องตรวจจับค่าความเข้มแสง เข้ากับ Adapter

3. เปิด cmd แล้วป้อนคำสั่ง cd lab63b RUN จากนั้นป้อนคำสั่ง cd lab07 แล้วทำการ RUN

4. ป้อนคำสั่ง vi src/main.cpp จะขึ้นโค้ดดังนี้

```
#include <Arduino.h>
#include <ESP8266WiFi.h>
int cnt = 0;
void setup()
{
  sensors.begin();
	Serial.begin(57600);
}
void loop()
{
  sensors.LightIntensity();
  Megajoule = sensors.getLightInByIndex(0);
  
	Serial.print(Megajoule);
  Serial.print(" Mg/J  ");

  delay(1000);
  
  if (Megajoule>=5){
                Serial.println("==== OFF ====");
                digitalWrite(0, LOW);
	} else (Megajoule<30){
		Serial.println("==== ON ====");
		digitalWrite(0, HIGH);

}
```

5. ทำการกดปุ่มดำเพื่ออัพโหลด และกดปุ่มข้างๆเพื่อทำการ reset สามารถดุูผลการอัพโหลดได้จากคำสั่ง pio device monitor

## การบันทึกผลการทดลอง
จากการทดลองจะเห็นได้ว่าเมื่อเซ็นเซอร์แสงตรวจจับค่าความเข้มแสงได้น้อยกว่า 5 เมกะจูล หลอดไฟ LED ก็จะเปร่งแสงสว่างออกมา โดยที่สามารถ input ค่าความเข้มแสงเพื่อเป็นการตรวจสอบค่าความเข้มแสงในช่วงเวลาดังกล่าวได้อีกด้วย ซึ่งหากค่าความเข้มแสงมากกว่า 5 เมกะจูล LED จะดับไฟโดยอัตโนมัติ

## อภิปรายผลการทดลอง
จากการทดลอง เมื่อทำการ RUN โปรแกรมลงไปในไมโครคอนโทรเลอร์ และนำเซ็นเซอร์แสงไปปไว้ในสถานที่ที่เราต้องการวัดค่าความเข้มแสงและต้องการให้ LED เกิดการติดไฟเพื่อเป็นแสงสว่างโดยที่หน้าจอจะแสดงผลจะสามารถ OUTPUT ค่าความเข้มแสงในช่วงเวลาน้ันๆให้ทราบได้อีกด้วย เมื่อค่าความเข้มแสงน้อยว่า 5 เมกะจูล หลอดไฟ LED ก็จะเปร่งแสง เเละ เมื่ออุณหภูมิมีค่ามากกว่า 5 องศา หลอดไฟ LED ก็จะดับลงโดยอัติโนมัติ

## คำถามท้ายการทดลอง
- หากมีอะไรไปบังที่ตัวเซ็นเซอร์แสงจะส่งผลกระทบกับค่าความเข้มแสงหรือไม่

ไม่ส่งผลเนื่องจากค่าความเข้มแสงทำการตรวจจับได้จากค่าความเข้มโดยรอบๆ ไม่จำเป็นที่จะต้องตรวจจับกับด้านบนเซ็นเซอร์แสงโดยตรง 
